<div class="container-fluid d-flex gap-2 h-100">
  <div class="right-nav order-2">
    <o3r-in-page-nav-pres
      id="rules-engine-nav"
      [links]="links$ | async"
    >
    </o3r-in-page-nav-pres>
  </div>
  <div
    class="order-1 overflow-scroll"
    data-bs-spy="scroll"
    data-bs-target="#rules-engine-nav"
    data-bs-smooth-scroll="true"
    tabindex="0"
  >
    <h1>Rules engine</h1>
    <h2 id="rules-engine-description">Description</h2>
    <p>
      This module provides a rule engine that can be executed on your Otter application to customize your application (translations, placeholders and configs) based on a json file generated by your CMS.
    </p>
    <h2 id="rules-engine-example">Example</h2>
    <div>
      <o3r-rules-engine-pres></o3r-rules-engine-pres>
      <p>
        Let's take our basic component, add some configurations, localize it, use dynamic content and implement some rules.
      </p>
      <p>
        Do not hesitate to run the application locally, if not installed yet, follow the <a routerLink="/run-app-locally">instructions</a>.
      </p>
      <a href="https://github.com/AmadeusITGroup/otter/blob/main/apps/showcase/src/components/showcase/rules-engine" target="_blank" rel="noopener">Source code</a>
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeRuleTab === 'configuration'" (click)="activateRuleTab('configuration')">Configuration rule</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeRuleTab === 'localization'" (click)="activateRuleTab('localization')">Localization rule</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeRuleTab === 'dynamic-content'" (click)="activateRuleTab('dynamic-content')">Dynamic content rule</a>
        </li>
      </ul>
      <div class="container">
        <div *ngIf="activeRuleTab === 'configuration'">
          By default, New-York is not selectable and we want to make it available only during the summer.
          <br>
          So we have created facts for the trip information and a new operator to evaluate the selected date.
          After that we set the following rule to make New-York available during the summer.
          <br>
          You can check that New-York will be available if you select dates during the summer (between June 21st and September 21st).
          <o3r-copy-text-pres [text]="newYorkAvailableRule"></o3r-copy-text-pres>
        </div>
        <div *ngIf="activeRuleTab === 'dynamic-content'">
          When selecting a date during the summer, the otter picture changes. We have created the following rule to change the targeted asset.
          <br>
          You can check that the image changes if you select dates during the summer (between June 21st and September 21st).
          <o3r-copy-text-pres [text]="summerOtterRule"></o3r-copy-text-pres>
        </div>
        <div *ngIf="activeRuleTab === 'localization'">
          When a destination is selected, the text will change from "Where do you want to go?" to "When do you want to go?". We have created the following rule to change the localization key.
          <o3r-copy-text-pres [text]="helloNewYorkRule"></o3r-copy-text-pres>
        </div>
      </div>
    </div>
    <h2 id="rules-engine-install">How to install</h2>
    <div>
      <o3r-copy-text-pres [wrap]="true" text="ng add @o3r/rules-engine"></o3r-copy-text-pres>
    </div>
    <h2 id="rules-engine-fact-creation">How to create a new fact</h2>
    <div>
      <o3r-copy-text-pres [wrap]="true" text="ng g facts-service FactsName"></o3r-copy-text-pres>
    </div>
    <h2 id="rules-engine-operator-creation">How to create a new operator</h2>
    <div>
      <o3r-copy-text-pres [wrap]="true" text="ng g operator OperatorName"></o3r-copy-text-pres>
    </div>
    <h2 id="rules-engine-metadata">Metadata</h2>
    <div>
      <h3>How to extract</h3>
      <o3r-copy-text-pres [wrap]="true" text="ng run project-name:extract-rules-engine"></o3r-copy-text-pres>
      <p>It will extract application facts and operators in the following files: <code>rules.facts.metadata.json</code> and <code>rules.operators.metadata.json</code></p>
      <p>Check the list of options available by running:</p>
      <o3r-copy-text-pres [wrap]="true" text="ng run project-name:extract-rules-engine --help"></o3r-copy-text-pres>
      </div>
    <h2 id="rules-engine-references">References</h2>
    <ul>
      <li>
        <a href="https://docs.otter.digitalforairlines.com/additional-documentation/rules-engine.html" target="_blank" rel="noopener">Documentation</a>
      </li>
      <li>
        <a routerLink="/configuration">Configuration</a>
      </li>
      <li>
        <a routerLink="/localization">Localization</a>
      </li>
      <li>
        <a routerLink="/dynamic-content">Dynamic content</a>
      </li>
    </ul>
  </div>
</div>
