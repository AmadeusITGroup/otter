<o3r-sdk-training-step-pres>
  <ng-container class="step-instructions">
    <h1>Generate an SDK from specifications</h1>
    <h2>Generator configuration</h2>
    <p>
      It is possible to configure the SDK code generation. To do so, you can either pass the parameters to the generator command line
      or by setting the values in the <b><code>openapitools.json</code></b> file.
    </p>

    <h3>Generator command line</h3>
    <p>
      Passing parameters to the generator command line will override the default configuration values.
      The available parameters are:
    </p>
    <table class="table table-striped">
      <thead>
      <tr>
        <th scope="col">Parameter</th>
        <th scope="col">Description</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td><b><code>--spec-path</code></b></td>
        <td>Path to the specification file used to generate the SDK</td>
      </tr>
      <tr>
        <td><b><code>--spec-config-path</code></b></td>
        <td>Path to the specification generation configuration</td>
      </tr>
      <tr>
        <td><b><code>--output-path</code></b></td>
        <td>Output path for the generated SDK</td>
      </tr>
      <tr>
        <td><b><code>--global-property</code></b></td>
        <td>Comma-separated string of options to give to the openapi-generator-cli</td>
      </tr>
      <tr>
        <td><b><code>--generator-custom-path</code></b></td>
        <td>Path to a custom generator</td>
      </tr>
      <tr>
        <td><b><code>--openapi-normalizer</code></b></td>
        <td>Rules for transforming the input specification to make it workable with OpenAPI Generator</td>
      </tr>
      </tbody>
    </table>

    <h3>OpenAPI Tools JSON file</h3>
    <p>
      There is also a possibility to configure the SDK code generation in <b><code>openapitools.json</code></b>.
      The structure for this file looks something like this:
    </p>
    <o3r-copy-text-pres language="json" text=
'{
  // ...
  "generator-cli": {
    "version": "0.0.0",
    "storageDir": ".openapi-generator",
    "generators": { // optional
      "example-sdk": { // any name you like
        "generatorName": "typescriptFetch",
        "output": ".",
        "inputSpec": "./openapi.yml"
      }
    }
  }
}'
    ></o3r-copy-text-pres>
    <p>
      <b><code>example-sdk</code></b> corresponds to the key of the generator which can be referenced in the generator command as a parameter, for example:
    </p>
    <o3r-copy-text-pres language="bash" [wrap]="true" text="yarn schematics @ama-sdk/schematics:typescript-core --generator-key example-sdk"></o3r-copy-text-pres>
    <p>
      The properties <b><code>generatorName</code></b>, <b><code>output</code></b>, and <b><code>inputSpec</code></b> are required and additional properties can be added (available properties
      described in the <a href="https://github.com/OpenAPITools/openapi-generator-cli/blob/master/apps/generator-cli/src/config.schema.json">OpenAPI Generator schema</a>).
      We will present the global properties that are provided by Otter in the following section.
    </p>
  </ng-container>

  <ng-container class="step-example">
    <h1>Example</h1>
    <h2>Configuration of the Otter Showcase SDK</h2>
    <p>
      Let's see how we configured the Otter Showcase SDK using the OpenAPI Tools JSON file and what its equivalent would be using the generator command line.
    </p>
    <h3>OpenAPI Tools JSON file</h3>
    <p>
      You will find below a snippet of the configuration file <b><code>openapitools.json</code></b> from the <a href="https://github.com/AmadeusITGroup/otter/blob/main/packages/@ama-sdk/showcase-sdk">Otter Showcase SDK</a>.
    </p>
    <o3r-copy-text-pres language="json" text=
'"generator-cli": {
  "version": "7.4.0",
  "storageDir": ".openapi-generator",
  "generators": {
    "ama-sdk-showcase-sdk": {
      "generatorName": "typescriptFetch",
      "output": ".",
      "inputSpec": "./openapi.yml",
      "globalProperty": {
        "stringifyDate": true
      }
    }
  }
}
'
    ></o3r-copy-text-pres>
    <p>
      This JSON file is based on the <a href="https://raw.githubusercontent.com/OpenAPITools/openapi-generator-cli/master/apps/generator-cli/src/config.schema.json">schema</a> provided by <b>&#64;openapitools/openapi-generator-cli</b>.
    </p>
    <p>
      It contains the required properties and the field <b><code>globalProperty</code></b>, which we will explain in the following section to understand how it impacts the generated SDK.
    </p>
    <p>
      The SDK is then generated using the following command line, available in its <b><code>package.json</code></b> file:
    </p>
    <o3r-copy-text-pres language="bash" [wrap]="true" text="yarn schematics @ama-sdk/schematics:typescript-core --generator-key ama-sdk-showcase-sdk"></o3r-copy-text-pres>

    <h3>Generator command line</h3>
    <p>
      Let's imagine that we do not have an <b><code>openapitools.json</code></b> file. The command line to run to generate the same SDK with equivalent configuration would be:
    </p>
    <o3r-copy-text-pres language="bash" [wrap]="true" text="yarn schematics @ama-sdk/schematics:typescript-core --spec-path ./openapi.yml --global-property stringifyDate"></o3r-copy-text-pres>
    <p>
      <ngb-alert dfInsertAlertIcon [type]="'info'" [dismissible]="false">
        The parameters <b><code>generatorName</code></b> and <b><code>output</code></b> don't need to be passed to the command line since the default values don't need to be overriden in this use case.
        You can find the default values for these options in the <a href="https://github.com/AmadeusITGroup/otter/blob/main/packages/%40ama-sdk/schematics/schematics/code-generator/open-api-cli-generator/open-api-cli.options.ts">&#64;ama-sdk/schematics package</a>.
      </ngb-alert>
    </p>
  </ng-container>
</o3r-sdk-training-step-pres>
